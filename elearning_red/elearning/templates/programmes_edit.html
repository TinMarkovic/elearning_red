{% extends "base.html" %}
{% block title %} Create programme {% endblock title %}
{% block content %}
<form method="post" action="" class="form-horizontal">
  <fieldset>
    {% csrf_token %}
	{{ form.as_p }}
     
 
    </fieldset>
    <input type="submit" value="Create programme" />
    
</form>

 <h1> Programmes in offer: </h1>
   <table class="table table-striped table-hover ", id="table_1">
    <thead>
    <tr class="info">
        <th>Name</th>
        <th>Average rating</th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
    </thead>
   
    {% for item in programmes %}
    <tr class="success" id={{item.id}}>
        <td>{{ item.name }}</td>
        <td>{{ item.avgRating }}</td>
        <td><a href={% url "elearning:editProgramme" programme_id=item.id %} class="btn btn-raised btn-success">Edit</a>
        <td><a href="" class="btn btn-raised btn-info">Details</a> </td>
        <td><a href={% url "elearning:showProgramme" programme_id=item.id %} class="btn btn-raised btn-danger">Enter</a> </td>
        <td> <a href="" class="btn btn-raised btn-warning deleteBlock">Delete</a> </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}


{% block script %}
<script>
$(document).ready( function () {
    $('#table_1').DataTable({"aoColumnDefs": [ { "bSortable": false, "aTargets": [ -1, -2, -3, -4 ] } ]})  
    
    
});
$(document).ready('click','.deleteBlock',function () {  
    
      $( ".deleteBlock" ).on("click", function( event, ui ) {
        $element = $(this).parents("tr");
        var programmes_id = $element.attr("id");
        event.stopPropagation();
        if(confirm("Are you certain you want to delete this programme?")){
            $.ajax({
                 type:"DELETE",
                 url:"/programmes/edit/" + programmes_id,
                 data: {},
                 success: function(){
                        $element.remove();
                }
            });
        }
    });
});
</script>
{% endblock script %}
